---
- trigger:
    - platform: event
      event_type: leaf_state
  binary_sensor:
    # Keep track how many days have past since a date
    - name: Leaf plug
      state: '{{ trigger.event.data.power != "UNPLUGGED" }}'
      device_class: plug
    - name: Leaf charging
      state: '{{ trigger.event.data.power == "CHARGING" }}'
      device_class: plug
      icon: mdi:ev-station
  sensor:
    - name: Leaf charge
      state: '{{ trigger.event.data.battery }}'
      unit_of_measurement: '%'
      device_class: battery
    - name: Leaf temperature
      state: '{{ trigger.event.data.temperature.split("-")[0]|int + 1 }}'
      unit_of_measurement: Â°C
      device_class: temperature
    - name: Leaf last update
      state: '{{ trigger.event.data.lastUpdated | timestamp_local}}'
      device_class: timestamp
